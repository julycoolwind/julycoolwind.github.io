---
layout: post
title:  "百度地图瓦片图层"
categories: 经验
---

* content
{:toc}

## 百度瓦片图层使用
经过了几天的探索和研究，终于成功使用了百度地图的瓦片图层功能。使用瓦片图层功能，可以在百度地图上边叠加自己的地图。对于特定的地图应用来说十分有用。比如做景区的导览，百度地图每一定收录的那么全，同时也不会更新的那么及时。在自己掌握景区数据的时候就可以自己画景区的地图，使用自己的地图叠加在百度地图之上，能够很好的完成定制地图的功能。   

### 基础知识准备
为了使用使用瓦片图层功能，最好提前了解一下相关的基础知识。

#### 瓦片图
瓦片图，顾名思义就像盖房子时用瓦片铺房顶一样，一片一片的排列最后构成一整张完整的大图。如下图所示：  
   
![瓦片图示例](http://7xs134.com1.z0.glb.clouddn.com/blogtile_sample.png)

这张图就是由16个瓦片(方格)构成的，瓦片的编号按照行和列进行编号，每个瓦片的宽和高都是256像素。一般瓦片都使用正方形，如果是自己设计的瓦片尺寸无所谓，有的游戏地图习惯使用宽个高为32像素的瓦片。使用地图的瓦片，一般都是256像素，所以这里就使用了256做示例。   

### 缩放层级

缩放层级可以理解为地图的放大比例，缩放层级越大，看到的细节越多。   
例如第一级的地图：   
![第一级地图示例](http://7xs134.com1.z0.glb.clouddn.com/bloglevel1map.png)   
一共使用了四个方块的区域来显示地图。地图没增加一级缩放级别，就意味着原来一个方格的区域需要使用四个方格来显示。如下图，就是增加了一级缩放级别。   
![第二级地图示例](http://7xs134.com1.z0.glb.clouddn.com/bloglevel2map.png)   
增加一级之后，首先地图的尺寸比原来大了一倍，高和宽都是X2。于是每个方格的面积不变的情况下，原来需要四个方格显示，现在需要16个方格来显示。    
由此可以发现，每一个缩放层级的方格数量是不同的。每个缩放层级的方格数量，是上一个层级的4倍。

根据这个规律我们就可以计算出需要缩放层级为n级的瓦片(x,y)在n+1层中对应的瓦片，进而可以推导出在n+m层中对应的瓦片。  
 
    n层的瓦片(x,y)对应n+1层的瓦片(x*4,y*4)(x*4+1,y*4)(x*4,y*4+1)(x*4+1,y*4+1)
    例：
    4层的瓦片(10,12)
    对应到5层为(40,48)(41,48)(40,49)(41,49)4个瓦片

### 百度地图的编码方式
百度地图演示层级加上x、y坐标的方式。具体的形式为zoom_x_y，如4层(10,12)瓦片，编码方式就是4_10_12。
> **小节**   
> 有了瓦片图和缩放层级的概念就能看懂百度地图瓦片图加载连接了。

### 墨卡托投影
